{"ast":null,"code":"/* global jQuery: false */\n\n/**\n * Simple connection class for using the XHR object in browsers\n *\n * @class {XhrConnection}\n */\nmodule.exports = JqueryConnector;\n\nvar utils = require('../utils');\n\nvar ConnectionAbstract = require('../connection');\n\nvar ConnectionFault = require('../errors').ConnectionFault;\n\nfunction JqueryConnector(host, config) {\n  ConnectionAbstract.call(this, host, config);\n}\n\nutils.inherits(JqueryConnector, ConnectionAbstract);\n\nJqueryConnector.prototype.request = function (params, cb) {\n  var ajax = {\n    url: this.host.makeUrl(params),\n    data: params.body,\n    type: params.method,\n    dataType: 'text',\n    headers: this.host.getHeaders(params.headers),\n    done: cb\n  };\n  var jqXHR = jQuery.ajax(ajax).done(function (data) {\n    cb(null, data, jqXHR.statusCode(), {\n      'content-type': jqXHR.getResponseHeader('content-type')\n    });\n  }).fail(function (a, b, err) {\n    // if response is available, execute cb. Else throw ConnectionFault\n    if (a && a.responseText) {\n      cb(null, a.responseText, jqXHR.statusCode(), {\n        'content-type': jqXHR.getResponseHeader('content-type')\n      });\n    } else {\n      cb(new ConnectionFault(err && err.message));\n    }\n  });\n  return function () {\n    jqXHR.abort();\n  };\n};","map":null,"metadata":{},"sourceType":"script"}